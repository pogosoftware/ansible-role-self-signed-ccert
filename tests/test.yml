---
- hosts: localhost
  become: yes
  roles:
    - self-signed-cert
  vars:
    selfSignedCerts:
      cfsslUrl: https://pkg.cfssl.org/R1.2/cfssl_linux-amd64
      cfssljsonUrl: https://pkg.cfssl.org/R1.2/cfssljson_linux-amd64

      certDir: /etc/certs/

      profiles:
      - name: server
        expirity: 8760h
        usages:
        - signing
        - key encipherment
        - server auth
        - client auth
      - name: client
        expirity: 8760h
        usages:
        - signing
        - key encipherment
        - client auth

      cas:
      - name: example
        cn: example.com
        keyAlgo: rsa
        keySize: 4096
        country: PL
        location: Wroclaw
        organisation: Pogosoftware
        organisationUnit: DevOps
        state: dolnoslaskie
        trustCaCert: true
      - name: example2
        cn: example2.com
        keyAlgo: rsa
        keySize: 4096
        country: PL
        location: Wroclaw
        organisation: Pogosoftware
        organisationUnit: DevOps
        state: dolnoslaskie
        trustCaCert: false

      certificates:
      - name: server
        profile: server
        caName: example
        exportToPfx: true
        cn: example.com
        hosts:
        - example.com
        - www.example.com
        keyAlgo: rsa
        keySize: 4096
        country: PL
        location: Wroclaw
        organisation: Pogosoftware
        organisationUnit: DevOps
        state: dolnoslaskie
      - name: client
        profile: client
        caName: example
        exportToPfx: true
        cn: example.com
        hosts:
        - example.com
        - www.example.com
        keyAlgo: rsa
        keySize: 4096
        country: PL
        location: Wroclaw
        organisation: Pogosoftware
        organisationUnit: DevOps
        state: dolnoslaskie